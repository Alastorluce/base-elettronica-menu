<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Base Elettronica Service - Menu</title>

  <!-- 🔹 Font principale -->
  <link href="https://fonts.googleapis.com/css?family=Varela+Round&display=swap" rel="stylesheet">

  <!-- 🔹 Icone e manifest -->
  <link rel="icon" type="image/x-icon" href="logo_multires.ico">
  <link rel="icon" type="image/png" sizes="256x256" href="logo_256.png">
  <link rel="apple-touch-icon" sizes="512x512" href="logo_512.png">
  <link rel="manifest" href="manifest.json">

  <!-- ============================
       BLOCCO: STILI COMPLETI
       ============================ -->
  <style>
    
  /* ----------------------------
     RESET E ACCESSIBILITÀ
  ---------------------------- */
  *, *::before, *::after {
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    scrollbar-width: thin;
    scrollbar-color: #00a6ff rgba(0, 0, 0, 0.5);
  }

  /* ----------------------------
     ANIMAZIONI BASE
  ---------------------------- */
  @keyframes fadeImage { from { opacity: 0; } to { opacity: 1; } }
  @keyframes slideInLogo { from { transform: translateX(-100%); opacity: 0;} to { transform: translateX(0); opacity: 1;} }
  @keyframes slideInSidebar { from { transform: translateX(-100%); opacity: 0;} to { transform: translateX(0); opacity: 1;} }
  @keyframes slideIn { from { transform: translateX(-100%); opacity: 0;} to { transform: translateX(0); opacity: 1;} }
  @keyframes pulse { 0%,100% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.1); } }
  @keyframes outlineSweep {
    0% {
      background-position: 0% 0%, 100% 0%, 100% 100%, 0% 100%;
    }
    100% {
      background-position: 300% 0%, 100% 300%, -200% 100%, 0% -200%;
    }
  }
  @keyframes radarTextScan {
    0% { background-position: 100% center; }
    100% { background-position: -100% center; }
  }

  /* ----------------------------
     MODALE: transizione istantanea per blocchi web
  ---------------------------- */
  #modal.instant-hide {
    transition: none !important;
  }

  /* ----------------------------
     WARNING ORIENTAMENTO MOBILE
  ---------------------------- */
  #orientation-warning {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: #000;
    z-index: 99999;
    align-items: center;
    justify-content: center;
    text-align: center;
  }
  .orientation-content {
    padding: 20px;
  }
  .orientation-content p {
    color: #00a6ff;
    font-size: 1.2em;
    margin-top: 15px;
    font-family: 'Varela Round', sans-serif;
  }

  /* ----------------------------
     LAYOUT GENERALE
  ---------------------------- */
  body {
    margin: 0;
    background: #000;
    font-family: 'Varela Round', sans-serif;
    color: #fff;
    display: flex;
    height: 100vh;
    overflow: hidden;
  }

  /* ----------------------------
     SIDEBAR SINISTRA
  ---------------------------- */
  #sidebar {
    width: 240px;
    background: #111;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1em;
    box-shadow: 2px 0 10px rgba(0, 166, 255, 0.2);
    z-index: 2;
    height: 100vh;
    flex-shrink: 0;
    opacity: 0;
    transform: translateX(-100%);
  }
  #sidebar.animated { animation: slideInSidebar 0.6s ease-out forwards; }

  #sidebar-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    width: 100%;
  }

  #sidebar-logo {
    margin-bottom: 2em;
    width: 180px;
    height: auto;
    cursor: pointer;
    transition: transform 0.3s ease, opacity 0.5s ease-in-out;
    opacity: 1;
  }
  #sidebar-logo img {
    width: 100%;
    height: auto;
    display: block;
    filter: brightness(90%) saturate(0%) contrast(150%) invert(10%);
    transition: transform 0.25s ease;
  }
  #sidebar-logo:active img { transform: scale(0.83); }
  #sidebar-logo:hover { transform: scale(1.05); }

  #right-glow {
    position: absolute;
    top: 0; right: 0;
    width: 2px; height: 100%;
    pointer-events: none;
    box-shadow:
      0 0 6px rgba(0, 166, 255, 0.2),
      0 0 12px rgba(0, 166, 255, 0.3);
    z-index: 1;
  }

  /* ----------------------------
     MENU PRINCIPALE E SUBMENU
  ---------------------------- */
  .menu-list {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
  }

  .menu-item {
    background: rgba(0,0,0,0.6);
    border: 1px solid rgba(0, 166, 255, 0.4);
    color: #00a6ff;
    padding: 0.5em 0.8em;
    margin-bottom: 1em;
    border-radius: 6px;
    cursor: pointer;
    will-change: transform, box-shadow;
    transition: transform 0.4s cubic-bezier(0.25,0.1,0.25,1), box-shadow 0.4s cubic-bezier(0.25,0.1,0.25,1);
    text-shadow: 1px 0.5px 1px #1900ff;
    text-align: center;
    width: 60%;
    font-size: 0.9em;
    opacity: 0;
    transform: translateX(-100%);
    animation: slideIn 0.5s ease-out forwards;
    position: relative;
    overflow: visible;
    z-index: 0;
    border-color: transparent !important;
  }

  .menu-item:hover {
    background: rgba(0, 0, 0, 0.8);
    color: #00ffb3;
    border-color: #00ffb3;
  }

  .menu-item::before {
    content: '';
    position: absolute;
    inset: 0;
    border: 1px solid #00a6ff;
    border-radius: 8px;
    z-index: 1;
    pointer-events: none;
  }

  .menu-item::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 8px;
    pointer-events: none;
    z-index: 1;
    background:
      linear-gradient(90deg, transparent 0%, #00ffff 95%, transparent 100%) top left / 400% 2px no-repeat,
      linear-gradient(180deg, transparent 0%, #00ffff 95%, transparent 100%) top right / 2px 400% no-repeat,
      linear-gradient(270deg, transparent 0%, #00ffff 95%, transparent 100%) bottom right / 400% 2px no-repeat,
      linear-gradient(0deg, transparent 0%, #00ffff 95%, transparent 100%) bottom left / 2px 400% no-repeat;
    background-repeat: no-repeat;
    -webkit-mask-image: linear-gradient(#fff 0 0);
    -webkit-mask-composite: destination-in;
    mask-image: linear-gradient(#fff 0 0);
    mask-composite: intersect;
    animation: outlineSweep var(--duration) ease-in-out infinite;
    animation-delay: var(--delay, 0s);
  }

  .menu-item.pressed,
  .menu-item.sotto-servizio.pressed,
  .menu-item.sotto-showroom.pressed {
    transform: translateX(0) scale(0.90) !important;
    box-shadow: inset 0 0 5px #00a6ff !important;
  }

  /* ----------------------------
     MAIN (contenuto centrale)
  ---------------------------- */
  #main {
    flex-grow: 1;
    background: #000;
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    min-width: 0;
    overflow: hidden;
    padding: 2em;
    box-sizing: border-box;
    opacity: 1;
    transition: opacity 0.5s ease-in-out;
  }

  #logo-btn {
    width: 350px;
    max-width: 90vw;
    height: auto;
    object-fit: contain;
    animation: pulse 2s infinite ease-in-out;
    z-index: 1;
    position: absolute;
    top: 55%;
    left: 50%;
    transform: translate(-50%, -50%) scale(2.3);
    transition: transform 0.4s ease-in-out, opacity 1s ease-in-out;
  }

  #logo-btn.loaded-img {
    animation: fadeImage 2s ease-in-out;
  }

  /* ----------------------------
     MODALE
  ---------------------------- */
  #modal-blocker {
    display: none;
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    z-index: 3;
    background: transparent;
  }

  #modal {
    background: rgba(0, 0, 0, 0.8);
    color: #fff;
    padding: 2em;
    border-radius: 15px;
    box-shadow: 0 0 5px rgba(0, 166, 255, 0.3);
    opacity: 0;
    pointer-events: none;
    width: 60%;
    margin: auto 10px;
    max-width: 900px;
    max-height: 70vh;
    overflow: hidden;
    backdrop-filter: blur(10px);
    transition: opacity 0.6s ease;
    z-index: 4;
    position: relative;
  }

  #modal.show { opacity: 1; pointer-events: auto; }
  #modal.fade-out { opacity: 0; pointer-events: none; }

  #modal-content {
    text-align: left;
    max-width: 800px;
    overflow-y: auto;
    max-height: 70vh;
    scrollbar-width: none;
  }

  #modal-content::-webkit-scrollbar {
    width: 0;
  }

  .auto-scroll-show #modal-content {
    scrollbar-width: thin;
    scrollbar-color: rgba(0,166,255,0.8) transparent;
  }

  .auto-scroll-show #modal-content::-webkit-scrollbar {
    width: 2px;
  }

  .auto-scroll-show #modal-content::-webkit-scrollbar-track {
    background: transparent;
  }

  .auto-scroll-show #modal-content::-webkit-scrollbar-thumb {
    background-color: rgba(0,166,255,0.8);
    border-radius: 2px;
  }

  .auto-scroll-show #modal-content::-webkit-scrollbar-thumb:hover {
    background-color: rgba(0,255,179,0.8);
  }

  #modal-content,
  #modal-content h2,
  #modal-content h3,
  #modal-content p,
  #modal-content ul {
    text-align: center;
  }

  #modal-content ul li {
    text-align: left;
  }

  /* ----------------------------
     LOGO WATERMARK IN BASSO
  ---------------------------- */
  #watermark-logo {
    display: none;
    position: fixed;
    bottom: 20%;
    left: 50%;
    transform: translateX(-50%);
    z-index: 10;
    opacity: 0;
    pointer-events: none;
    filter: drop-shadow(0 0 4px #000);
    transition: opacity 0.02s ease;
  }

  #watermark-logo img {
    max-width: 400px;
    height: auto;
    display: block;
    filter: brightness(120%) contrast(90%);
  }

  /* ----------------------------
     TESTO GLOW RADAR
  ---------------------------- */
  .radar-glow {
    font-size: 2em;
    font-weight: bold;
    color: transparent;
    background-image: linear-gradient(
      90deg,
      #444343 0%,
      #727272 40%,
      #ffffff 50%,
      #727272 60%,
      #444343 80%
    );
    background-size: 200% auto;
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: radarTextScan 6s linear infinite;
    display: inline-block;
  }

  /* ----------------------------
     GALLERIA / SHOWROOM
  ---------------------------- */
  .gallery-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 15px;
    padding: 20px;
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
  }

  .gallery-item {
    position: relative;
    overflow: hidden;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    aspect-ratio: 16/9;
  }

  .gallery-item:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
  }

  .gallery-item img,
  .gallery-item video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .video-indicator {
    position: absolute;
    top: 10px;
    right: 10px;
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
  }

  /* ----------------------------
     VISTA FULLSCREEN GALLERIA
  ---------------------------- */
  .fullscreen-view {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
  }

  .fullscreen-view.active {
    opacity: 1;
    pointer-events: auto;
  }

  .fullscreen-content {
    max-width: 90%;
    max-height: 90%;
    position: relative;
  }

  .fullscreen-content img,
  .fullscreen-content video {
    max-width: 100%;
    max-height: 90vh;
    display: block;
    border-radius: 4px;
  }

  .close-fullscreen {
    position: absolute;
    top: -40px;
    right: 0;
    background-color: transparent;
    color: white;
    border: none;
    font-size: 24px;
    cursor: pointer;
  }

  /* ----------------------------
     STILI VIDEO BACKGROUND LOGO
  ---------------------------- */
  video#logo-btn {
    object-fit: cover;
    width: 100vw !important;
    height: 100vh !important;
    max-width: 100%;
    max-height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    transform: none !important;
    z-index: 1;
  }

  </style>


</head>

<body>
<div id="media-preloader" style="display:none;"></div>



    <div id="right-glow"></div>
  
    <div id="orientation-warning">
      <div class="orientation-content">
        <svg xmlns="http://www.w3.org/2000/svg" width="120" height="120"
             viewBox="0 0 24 24" fill="#00a6ff">
          <path d="M17 15h2V7h-2v8zm0 4h2v-2h-2v2zm-4-8h2V3h-2v8zm0
                   4h2v-2h-2v2zM9 9h2V7H9v2zm0 4h2v-2H9v2zm0-8h2V3H9v2zm0
                   12h2v-2H9v2zm-4-4h2v-2H5v2zm0-4h2V7H5v2zm0-4h2V3H5v2zm0
                   12h2v-2H5v2z"/>
        </svg>
        <p>Ruota il telefono in verticale per vedere il sito</p>
      </div>
    </div>
  
    <div id="sidebar">
      <div id="sidebar-content">
        <div id="sidebar-logo" onclick="ripristinaMenuPrincipale()">
           <img src="logo.png" alt="Logo">
        </div>
  
        <div class="menu-list">
          <div class="menu-item" onclick="apri(0)">Chi siamo</div>
          <div class="menu-item" onclick="toggleSubmenu('servizi')">I nostri servizi</div>
          <div class="menu-item" onclick="apri(1)">Portfolio</div>
          <div class="menu-item" onclick="toggleSubmenu('showroom')">Showroom</div>
          <div class="menu-item" onclick="apri(2)">Preventivi e Contatti</div>
  
          <!-- SOTTOMENU SERVIZI VISIBILE SOLO AL CLICK -->
          <div id="submenu-servizi" style="display:none; flex-direction: column; align-items: center; width: 100%;">
            <div class="menu-item sotto-servizio" onclick="apriSubservizio('service')">Service</div>
            <div class="menu-item sotto-servizio" onclick="apriSubservizio('antincendio')">Sicurezza Antincendio</div>
            <div class="menu-item sotto-servizio" onclick="apriSubservizio('progettazione')">Progettazione e Soluzioni su misura</div>
            <div class="menu-item sotto-servizio" onclick="apriSubservizio('noleggio')">Noleggio</div>
            <div class="menu-item sotto-servizio" onclick="apriSubservizio('assistenza')">Centro Assistenza Riparazioni</div>
            <div class="menu-item sotto-servizio" onclick="ripristinaMenuPrincipale()"
     style="color: #6A0DAD; border-color: #6A0DAD;">
  Menu principale
</div>
          </div>
          
          <!-- SOTTOMENU SHOWROOM VISIBILE SOLO AL CLICK -->
          <div id="submenu-showroom" style="display:none; flex-direction: column; align-items: center; width: 100%;">
            <div class="menu-item sotto-showroom" onclick="apriShowroom('service')">Service e spettacolo</div>
            <div class="menu-item sotto-showroom" onclick="apriShowroom('antincendio')">Sicurezza Antincendio</div>
            <div class="menu-item sotto-showroom" onclick="ripristinaMenuPrincipale()"
     style="color: #6A0DAD; border-color: #6A0DAD;">
  Menu principale
</div>
          </div>
        </div>
      </div>
    </div>
  
    <div id="main">
  <img src="logo.png" id="logo-btn" alt="Logo">

  <!-- Watermark centrato in basso -->
  <div id="watermark-logo">
    <img src="logo.png" alt="Watermark Logo">
  </div>

  <!-- Layer fantasma per bloccare click al di sotto -->
  <div id="modal-blocker"></div>

  <div id="modal" class="modal">
       <button class="modal-close" onclick="apri(currentIndex)">×</button>
       <div id="modal-content"><h2>Caricamento...</h2></div>
     </div>
     
  <!-- Contenitore per la galleria -->
  <div id="gallery-view" style="display: none; width: 100%; height: 100%; overflow-y: auto;">
    <div class="gallery-container" id="gallery-container"></div>
  </div>
  
  <!-- Vista a schermo intero -->
  <div class="fullscreen-view" id="fullscreen-view">
    <div class="fullscreen-content" id="fullscreen-content"></div>
  </div>
  </div>


<div id="video-preload-container" style="display:none;"></div>

  
    <script>

/**
 * Ferma qualunque timeout o RAF pendente sul container `el`
 */
function clearAutoScroll(el) {
  if (el._scrollTimeout) {
    clearTimeout(el._scrollTimeout);
    el._scrollTimeout = null;
  }
  if (el._scrollRaf) {
    cancelAnimationFrame(el._scrollRaf);
    el._scrollRaf = null;
  }
}

function isScrollable(el) {
  const cs = getComputedStyle(el);
  return (cs.overflowY === 'auto' || cs.overflowY === 'scroll')
         && el.scrollHeight > el.clientHeight;
}

function setupAutoScroll(el, speed = 11, delay = 9000) {
  // 0) Stoppa qualunque scroll in corso
  clearAutoScroll(el);

  // 0.1) Se c'era già un listener, lo rimuoviamo
  if (el._clickHandler) {
    el.removeEventListener('click', el._clickHandler);
    el._clickHandler = null;
  }

  let last = null;
  let active = false;
  let remainder = 0;

  el.classList.add('auto-scroll-hide');
  el.classList.remove('auto-scroll-show');

  function step(ts) {
    if (!active) return;
    if (!last) last = ts;
    const d = ts - last;
    last = ts;

    const raw = (d * speed) / 1000 + remainder;
    const move = Math.floor(raw);
    remainder = raw - move;

    if (move > 0) {
      el.scrollTop += move;
      if (el.scrollTop + el.clientHeight >= el.scrollHeight) {
        active = false;
        return;
      }
    }
    el._scrollRaf = requestAnimationFrame(step);
  }

  function start() {
    if (active) return;
    remainder = 0;   // resetta le frazioni accumulate
    last = null;
    active = true;
    el.classList.add('auto-scroll-hide');
    el.classList.remove('auto-scroll-show');
    el._scrollRaf = requestAnimationFrame(step);
  }

  function stop() {
  // Ferma qualunque start pendente o RAF in corso
  clearAutoScroll(el);
  // e marca lo stato come "non attivo"
  active = false;
  el.classList.remove('auto-scroll-hide');
  el.classList.add('auto-scroll-show');
}


  // 1) Prepara un unico clickHandler nominato
  el._clickHandler = () => {
    active ? stop() : start();
  };

  // 2) Solo al termine del delay: avvia lo scroll e collega il clickHandler
  el._scrollTimeout = setTimeout(() => {
    start();
    el.addEventListener('click', el._clickHandler);
  }, delay);
}

function initScrollOn(root) {
  clearAutoScroll(root);
  root.scrollTop = 0;

  const isDesktop = window.matchMedia('(min-width: 769px)').matches;
  const speed = isDesktop ? 20 : 11;
  const delay = 9000;

  if (root.scrollHeight > root.clientHeight) {
    setupAutoScroll(root, speed, delay);
  }
}

function showModalWithScroll() {
  [modal, modalContent].forEach(el => {
    clearAutoScroll(el);
    el.scrollTop = 0;
  });

  modal.classList.remove('fade-out');
  modal.classList.add('show');
  isTransitioning = false;

  initScrollOn(modal);
  initScrollOn(modalContent);
}









      const contenuti = [
        `<!-- Chi siamo -->
<div style="text-align:center;">
  <h2 class="radar-glow">Chi siamo</h2>                    
  <h2 style="color:#00a6ff; margin-top:0;">Base Elettronica Service</h2>
</div>

<p style="text-align:justify;">
Siamo una realtà consolidata con oltre 30 anni di esperienza nel settore della tecnologia applicata agli eventi, agli ambienti professionali e agli impianti integrati.</p>

<p>Operiamo su tutto il territorio nazionale offrendo servizi altamente specializzati nella <em>progettazione, installazione e gestione</em> di impianti <strong>audio, video, luci, sicurezza, automazione e antincendio</strong>, con un approccio multidisciplinare che integra know-how tecnico, creatività progettuale e rigore normativo.</p>

<p>Il nostro team è composto da tecnici qualificati, progettisti certificati e operatori esperti, in grado di affrontare ogni fase operativa: dal sopralluogo iniziale alla consegna chiavi in mano, passando per modellazione acustica, rendering 3D, collaudi funzionali e formazione all'utilizzo delle tecnologie installate.</p>

<p>Collaboriamo con enti pubblici, aziende private, studi di architettura, service per lo spettacolo e broadcaster televisivi, adattando ogni progetto alle esigenze specifiche del cliente con <strong>soluzioni su misura, scalabili e ad alta efficienza</strong>.</p>

<p>Lavoriamo con attrezzature all'avanguardia e standard qualitativi elevati, ponendoci come partner di riferimento per eventi live, showroom, installazioni fisse, studi televisivi, ambienti immersivi e produzioni ad alto impatto tecnologico.</p>
`,
  
        `<!-- Portfolio -->
<div style="text-align:center;">
  <h2 class="radar-glow">Portfolio</h2>
</div>

<p>Nel corso degli anni abbiamo contribuito alla realizzazione tecnica e progettuale di numerosi eventi, installazioni e ambienti professionali in tutta Italia. Il nostro portfolio riflette la varietà e l'elevato standard qualitativo dei servizi offerti.</p>

<ul>
  <li><strong style="color:#00a6ff;">Festival Nazionali e Tour Musicali</strong>: service completo per eventi live, dalla fase di pre-produzione alla regia tecnica in loco, con artisti di fama nazionale e internazionale.</li>
  <li><strong style="color:#00a6ff;">Installazioni in teatri e auditorium</strong>: sistemi fissi audio/luci/video integrati per spettacoli, musical, conferenze e produzioni culturali, con controllo centralizzato e interfacce utente dedicate.</li>
  <li><strong style="color:#00a6ff;">Soluzioni per centri congressi e showroom</strong>: impianti multimediali e di traduzione simultanea, videowall, microfonazione digitale e ambienti immersivi per la presentazione di brand e prodotti.</li>
  <li><strong style="color:#00a6ff;">Supporto tecnico per fiere, sfilate e dirette streaming</strong>: copertura A/V integrata, cablaggi fibra, ponti radio e mixer broadcast, con assistenza tecnica continua.</li>
  <li><strong style="color:#00a6ff;">Realizzazione di studi televisivi</strong>: progettazione e allestimento completo di ambienti televisivi e regie broadcast, con sistemi di illuminazione a LED, fondali scenografici, cablaggi audio/video digitali, pareti acustiche e regia IP-ready per produzioni live e on demand.</li>
</ul>

<p><em><span role="button" onclick="apri(2)" style="color:#00ffb3; text-decoration:none;cursor:pointer;">
  Contattaci
</span></em>&nbsp;per ricevere un portfolio dettagliato con referenze certificate, fotografie dei lavori realizzati e descrizioni tecniche complete.</p>

<p style="margin-top:1.5em;"><em><span role="button" onclick="attivaSlideshow()" style="color:#00ffb3; text-decoration:none;cursor:pointer;">
  Avvia
</span></em>&nbsp;una piccola anteprima nella showroom interattiva.</p>

`,
  
        `<!-- Contattaci -->
<div style="text-align:center;">
  <h2 class="radar-glow">Contattaci</h2>
</div>

<p>Hai un progetto da realizzare, un evento da organizzare o necessiti di assistenza tecnica? Il nostro team è a tua disposizione per consulenze, preventivi gratuiti e sopralluoghi personalizzati.</p>
<p>Compila il modulo sottostante per essere ricontattato dal nostro CEO <strong>Fabrizio Di Filippo</strong> o da un nostro tecnico incaricato.</p>

<div style="backdrop-filter: blur(10px); background:rgba(0,0,0,0.5); padding:2em; border-radius:15px; border:1px solid rgba(0,166,255,0.2); box-shadow:0 0 5px rgba(0,166,255,0.3);">
  <form id="contact-form" style="display:flex; flex-direction:column; gap:1em;">
    <label>
      <span style="display:block; margin-bottom:0.3em;">Nome e Cognome</span>
      <input type="text" placeholder="Mario Rossi" required style="width:100%; padding:0.75em; background:rgba(10,10,10,0.7); border:1px solid #00a6ff; color:#fff; border-radius:8px; outline:none;">
    </label>
    <label>
      <span style="display:block; margin-bottom:0.3em;">Email</span>
      <input type="email" placeholder="tu@email.it" required style="width:100%; padding:0.75em; background:rgba(10,10,10,0.7); border:1px solid #00a6ff; color:#fff; border-radius:8px; outline:none;">
    </label>
    <label>
      <span style="display:block; margin-bottom:0.3em;">Messaggio</span>
      <textarea rows="10" placeholder="Descrivi il tuo progetto, le tue esigenze o richiedi una consulenza tecnica." required style="width:100%; min-height:180px; padding:0.75em; background:rgba(10,10,10,0.7); border:1px solid #00a6ff; color:#fff; border-radius:8px; outline:none;"></textarea>
    </label>
    <button type="submit" style="padding:0.8em 1.5em; background:#00a6ff; color:#000; border:none; border-radius:8px; font-weight:bold; cursor:pointer;">
      Invia Richiesta
    </button>
  </form>
</div>
`
      ];

    const contenutoHome = `
  <div style="text-align: center; max-width: 700px; margin: 50px auto;">
    <h2 style="margin-bottom: 10px; color: white;">Benvenuti in</h2>
    <h1 style="color: #00aaff; font-size: 2.5em; margin-top: 0;">Base Elettronica Service</h1>
    <p style="font-size: 1.2em; color: white;">
      Siamo il partner ideale per progettazione, noleggio e gestione tecnica di impianti audio, video, luci e sicurezza per eventi e installazioni professionali.
      <br><br>
      Scopri di più esplorando il nostro sito!
    </p>
  </div>
`;

let onMain = true;
let modal = document.getElementById('modal');
let modalContent = document.getElementById('modal-content');
let currentIndex = null;
let isTransitioning = false;
let slideshowAttivo = false;
let slideshowInterval = null;
let currentSubmenu = null;

function apri(index) {
  if (isTransitioning) return;
  isTransitioning = true;

  const blocker = document.getElementById('modal-blocker');
  if (typeof autoHide !== 'undefined' && autoHide !== null) {
    clearTimeout(autoHide);
    autoHide = null;
  }
  if (blocker.style.display === 'block') {
    blocker.style.display = 'none';
  }

  // Nascondi la galleria se visibile
  document.getElementById('gallery-view').style.display = 'none';

  const fineTransizione = () => { isTransitioning = false; };

  if (currentIndex === index) {
    modal.classList.remove('show');
    modal.classList.add('fade-out');
    setTimeout(() => {
      modal.classList.remove('fade-out');
      modalContent.innerHTML = '';
      currentIndex = null;
      fineTransizione();
    }, 600);
    return;
  }

  currentIndex = index;
  if (modal.classList.contains('show')) {
    modal.classList.remove('show');
    modal.classList.add('fade-out');
    setTimeout(() => {
      modalContent.innerHTML = contenuti[index];
      showModalWithScroll();
      fineTransizione();
    }, 600);
  } else {
    modalContent.innerHTML = contenuti[index];
    showModalWithScroll();
    fineTransizione(); // <-- aggiunto per sicurezza
  }
}

function toggleSubmenu(tipo) {
  if (isTransitioning) return;
  isTransitioning = true;
  onMain = false;
  
  const logo = document.getElementById('sidebar-logo');
  const submenuServizi = document.getElementById('submenu-servizi');
  const submenuShowroom = document.getElementById('submenu-showroom');
  const menuItems = document.querySelectorAll('.menu-list > .menu-item');
  
  // Nascondi la galleria se visibile
  document.getElementById('gallery-view').style.display = 'none';

  logo.style.opacity = '0';

  setTimeout(() => {
    // Nascondi i principali
    menuItems.forEach(el => {
      if (!el.closest('#submenu-servizi') && !el.closest('#submenu-showroom')) {
        el.style.display = 'none';
        el.classList.remove('animated');
      }
    });

    // Chiudi l'altro submenu se aperto
    if (tipo === 'servizi') {
      submenuShowroom.style.display = 'none';
      submenuServizi.style.display = 'flex';
      currentSubmenu = 'servizi';
    } else if (tipo === 'showroom') {
      submenuServizi.style.display = 'none';
      submenuShowroom.style.display = 'flex';
      currentSubmenu = 'showroom';
    }

    // Poi, DOPO un ciclo di rendering, aggiungi l'animazione
    setTimeout(() => {
      const activeSubmenu = tipo === 'servizi' ? submenuServizi : submenuShowroom;
      activeSubmenu.querySelectorAll('.menu-item').forEach((el, i) => {
        el.classList.remove('animated'); // per sicurezza
        el.style.animation = 'none';     // resetta animazione
        void el.offsetWidth;             // forza reflow
        el.style.animation = '';         // riattiva
        el.classList.add('animated');
      });
    }, 30); // sufficiente per far partire l'animazione pulita

    logo.style.opacity = '1';
    isTransitioning = false;
  }, 500);
}

function ripristinaMenuPrincipale() {
  if (isTransitioning) return;

  const main      = document.getElementById('main');
  const sidebar   = document.getElementById('sidebar');
  const submenuServizi = document.getElementById('submenu-servizi');
  const submenuShowroom = document.getElementById('submenu-showroom');
  const watermark = document.getElementById('watermark-logo');
  const smallLogo = document.getElementById('sidebar-logo');
  const centralLogo = document.getElementById('logo-btn');
  const modal     = document.getElementById('modal');
  const galleryView = document.getElementById('gallery-view');

  // SE SONO GIÀ SUL MAIN (submenu chiuso, nessuna modale, nessuno slideshow e nessuna galleria), esci
  if (
    submenuServizi.style.display === 'none' &&
    submenuShowroom.style.display === 'none' &&
    !modal.classList.contains('show') &&
    !slideshowAttivo &&
    galleryView.style.display === 'none'
  ) {
    return;
  }

  isTransitioning = true;

  // 0) fade‐out del logo piccolo
  smallLogo.style.opacity = '0';
  // 1) fade‐out del main
  main.style.opacity = '0';

  setTimeout(() => {
    // A) ferma slideshow
    if (slideshowInterval) {
      clearInterval(slideshowInterval);
      slideshowInterval = null;
    }
    slideshowAttivo = false;
    watermark.style.display = 'none';
    document.body.style.overflow = '';

    // B) chiudi modale se aperta
    if (modal.classList.contains('show')) {
      modal.classList.remove('show');
      modal.classList.add('fade-out');
      setTimeout(() => {
        modal.classList.remove('fade-out');
        modalContent.innerHTML = '';
        currentIndex = null;
        isTransitioning = false;
      }, 600);
    }

    // C) nascondi galleria se aperta
    galleryView.style.display = 'none';

    // D) ripristina sidebar e menu
    submenuServizi.style.display = 'none';
    submenuShowroom.style.display = 'none';
    document.querySelectorAll('.menu-list > .menu-item')
            .forEach(el => el.style.display = 'flex');
    sidebar.style.display = '';

    // E) reset logo centrale
    centralLogo.classList.remove('loaded-img','loading','pulse');
    centralLogo.style.transition = 'none';
    centralLogo.style.transform  = 'translate(-50%,-50%) scale(2.3)';
    centralLogo.style.opacity    = '0';
    centralLogo.style.visibility = 'hidden';

    // preload e fade-in logo centrale
    const preload = new Image();
    preload.src = 'logo.png';
    preload.onload = () => {
      centralLogo.src = preload.src;
      void centralLogo.offsetWidth; 
      centralLogo.style.transition  = 'opacity 0.6s ease-in-out, transform 0.4s ease-in-out';
      centralLogo.style.visibility  = 'visible';
      centralLogo.style.opacity     = '1';
      centralLogo.style.transform   = 'translate(-50%,-50%) scale(2.3)';
      setTimeout(() => centralLogo.classList.add('pulse'), 600);
    };

    // 3) fade-in di main e logo piccolo
    main.style.opacity      = '1';
    smallLogo.style.opacity = '1';

    // 4) fine transizione
    setTimeout(() => {
      isTransitioning = false;
    }, 600);

  }, 500);
}

function apriSubservizio(tipo) {
  if (isTransitioning) return;
  isTransitioning = true;

  let contenuto = '';
  switch (tipo) {
    case 'service':
     
  contenuto = `

  <div style="text-align:center;">
    <h2 class="radar-glow">Service Tecnico per Eventi e Spettacoli</h2>
  </div>

<p>Offriamo un servizio integrato per l'allestimento tecnico di eventi di qualsiasi scala, in conformità al <strong>D.Lgs. 81/08</strong> e alle normative vigenti in materia di sicurezza, acustica e compatibilità elettromagnetica.</p>

<p>La nostra struttura operativa è progettata per garantire continuità, affidabilità e tempestività nelle seguenti aree:</p>

<ul class="custom-list">
  <li><strong>Progettazione tecnica preliminare</strong> con sopralluogo, elaborazione planimetrie e simulazioni acustico-visive su CAD 2D/3D;</li>
  <li><strong>Montaggio e collaudo</strong> di strutture portanti, layer, americane, passerelle e punti di sospensione certificati, con utilizzo di DPI e verifiche secondo norme UNI EN;</li>
  <li><strong>Configurazione impianti audio/luci/video</strong> con sistemi professionali (RCF, L-Acoustics, Meyer Sound, DiGiCo, GrandMA) ottimizzati per ogni tipologia di venue indoor e outdoor;</li>
  <li><strong>Cablaggio elettrico e segnale</strong> (audio, DMX, HDMI, fibra ottica) con certificazione a norma CEI 64-8 e messa a terra equipotenziale temporanea;</li>
  <li><strong>Regia tecnica on-site</strong> durante lo spettacolo, con operatori specializzati per la gestione in tempo reale di scena, mixer, luci, effetti speciali e visual show;</li>
  <li><strong>Supporto tecnico in studi televisivi</strong> con gestione audio-video, routing digitale, timecode, multicamera e coordinamento interfonico professionale per regie live e on-demand;</li>
  <li><strong>Disallestimento controllato</strong> e verifica post-evento per il ripristino in sicurezza dell'area e il tracciamento dei materiali a noleggio.</li>
</ul>

<p>Tutti i tecnici coinvolti sono formati secondo i moduli PES-PAV-PEI, piattaforme aeree (PLE), antincendio rischio elevato e movimentazione carichi in sicurezza, con copertura assicurativa completa.</p>

<p>Grazie a un parco attrezzature costantemente aggiornato, una logistica precisa e una mentalità orientata al risultato, ci poniamo come unico interlocutore tecnico per eventi, concerti, festival, congressi, produzioni televisive e corporate.</p>`;
  break;

      case 'antincendio':
  contenuto = `
   

  <div style="text-align:center;">
    <h2 class="radar-glow">Sistemi di Sicurezza Antincendio</h2>
  </div>

    <p>Progettiamo e installiamo impianti antincendio conformi alle normative vigenti, con particolare attenzione alla certificazione <strong>UNI EN 54</strong>, garantendo affidabilità, integrazione e tempestività d'intervento.</p>
    <p>Le nostre soluzioni comprendono:</p>
    <ul class="custom-list">
      <li><strong>Rivelazione automatica</strong> tramite sensori ottici, termici e multispettrali ad alta sensibilità;</li>
      <li><strong>Attuazione immediata</strong> mediante sirene, pannelli di evacuazione luminosa e dispositivi elettromeccanici;</li>
      <li><strong>Gestione centralizzata</strong> con centrali di controllo modulari, interfacciabili con sistemi BMS e di videosorveglianza;</li>
      <li><strong>Integrazione con sistemi audio/luci</strong> per l'attivazione di scenari di sicurezza e comunicazioni vocali di emergenza;</li>
      <li><strong>Monitoraggio remoto</strong> e manutenzione predittiva su infrastrutture industriali, civili e per eventi temporanei.</li>
    </ul>
    <p>Ogni progetto viene sviluppato in sinergia con i nostri ingegneri e tecnici certificati, per garantire la massima copertura del rischio e la piena conformità alle normative nazionali ed europee.</p>
  `;
  break;

  case 'progettazione':
  contenuto = `
    

  <div style="text-align:center;">
    <h2 class="radar-glow">Progettazione Ambienti e Soluzioni su Misura</h2>
  </div>

    <p>Forniamo un servizio completo di progettazione tecnica per ambienti professionali, eventi e installazioni fisse, combinando <strong style="color:#00a6ff;">esperienza ingegneristica</strong>, <strong style="color:#00a6ff;">tecnologie CAD 3D</strong> e <strong style="color:#00a6ff;">modellazione acustico-visiva</strong> ad alta precisione.</p>

    <ul class="custom-list">
      <li><strong style="color:#00a6ff;">Rendering e modellazione 3D</strong>: simulazioni fotorealistiche e interattive per impianti audio/luci/video, con valutazione dell'impatto estetico e funzionale negli spazi architettonici esistenti.</li>
      <li><strong style="color:#00a6ff;">Analisi acustiche e illuminotecniche</strong>: calcolo dei tempi di riverbero, distribuzione sonora, luminanza e contrasto visivo, con software specializzati per ambienti teatrali, conferenziali e studi di registrazione.</li>
      <li><strong style="color:#00a6ff;">Personalizzazione scenotecnica</strong>: studio e realizzazione di elementi su misura (fondali, layer, pareti mobili, set modulari) con soluzioni ad alta efficienza energetica e flessibilità installativa.</li>
      <li><strong style="color:#00a6ff;">Progettazione studi televisivi e regie</strong>: sviluppo integrato di spazi broadcast con isolamento acustico, pareti foniche, illuminazione a LED calibrata, pannellature tecniche e sistemi di controllo centralizzato IP.</li>
    </ul>

    <p>Ogni progetto è accompagnato da <strong style="color:#00a6ff;">documentazione tecnica dettagliata</strong>, planimetrie esecutive e consulenza dedicata nella fase di cantiere. Il nostro approccio modulare ci consente di soddisfare le esigenze sia di piccoli eventi privati sia di grandi produzioni professionali, garantendo risultati impeccabili e piena coerenza normativa.</p>
  `;
  break;

  case 'noleggio':
  contenuto = `
    

  <div style="text-align:center;">
    <h2 class="radar-glow">Noleggio di Attrezzature Professionali</h2>
  </div>

    <p>Offriamo un servizio di noleggio completo per impianti e attrezzature di alta gamma nel settore <strong>audio, video, luci, strutture e controllo scenotecnico</strong>, con disponibilità immediata, contratti flessibili e assistenza tecnica qualificata.</p>

    <p>Il nostro parco attrezzature è regolarmente revisionato, aggiornato e conforme alle normative CE, EN 60598-2-17 (illuminotecnica), CEI 64-8 (impiantistica elettrica) e D.Lgs. 81/08 per la sicurezza nei luoghi di lavoro.</p>

    <ul class="custom-list">
      <li><strong>Diffusione sonora professionale</strong>: line array e subwoofer RCF, L-Acoustics, Meyer Sound, d&b audiotechnik;</li>
      <li><strong>Mixer digitali</strong>: DiGiCo, Yamaha CL/QL Series, Midas, Soundcraft, Allen & Heath;</li>
      <li><strong>Console luci</strong>: GrandMA3, Avolites, ChamSys, con supporto per pixel mapping e timecode;</li>
      <li><strong>Proiettori, teste mobili e LED</strong>: ROBE Lighting, Prolights, DTS, Clay Paky;</li>
      <li><strong>Videoproiezione e LEDwall</strong>: pannelli LED pitch 2.6/3.9 indoor/outdoor, scalers e matrici video, proiettori laser full HD/4K;</li>
      <li><strong>Strutture e supporti</strong>: americane truss, layer certificati, motori elettrici e manuali, palchi modulari, torri di sollevamento;</li>
      <li><strong>Cabling e networking</strong>: cablaggio segnale e potenza, stage box Dante, switch professionali per reti AVB/Art-Net/sACN;</li>
      <li><strong>Accessori e sicurezza</strong>: quadri elettrici CEI, canaline, copricavi, flight case, dispositivi antinfortunistici per montaggio in quota.</li>
    </ul>

    <p>È possibile stipulare contratti di <strong>noleggio giornaliero, settimanale, mensile o a lungo termine</strong>, con servizio opzionale di consegna, installazione, supervisione tecnica e smontaggio.</p>

    <p>Ogni richiesta viene gestita con analisi tecnica preliminare, scheda materiali dettagliata e supporto nella scelta della configurazione più efficiente rispetto all'ambiente operativo e al tipo di evento.</p>
  `;
  break;

  case 'assistenza':
  contenuto = `
    

  <div style="text-align:center;">
    <h2 class="radar-glow">Centro Assistenza Tecnica e Riparazioni</h2>
  </div>

    <p>Il nostro centro tecnico offre un servizio specializzato di assistenza e riparazione su attrezzature <strong>audio, luci, video, strutture elettroniche e digitali</strong>, con interventi tempestivi sia <strong>on-site</strong> che in <strong>laboratorio interno certificato</strong>.</p>

    <p>Siamo in grado di eseguire <strong>riparazioni elettroniche su qualsiasi componente</strong>, anche a livello microelettronico e SMT, grazie a un reparto dotato di strumentazione avanzata per diagnostica, collaudo e ricostruzione circuitale.</p>

    <ul class="custom-list">
      <li><strong>Apparati audio professionali</strong>: amplificatori, mixer digitali, stage box, processori DSP;</li>
      <li><strong>Corpi illuminanti e console luci</strong>: teste mobili, dimmer, centraline DMX, alimentatori switching;</li>
      <li><strong>Sistemi video</strong>: proiettori laser, scaler, matrici, convertitori SDI/HDMI e trasmettitori ottici;</li>
      <li><strong>Alimentazione e cablaggi</strong>: quadri elettrici, PSU, connettori industriali, reti AVB/Art-Net.</li>
    </ul>

    <p><strong>Ogni intervento è accompagnato da diagnosi documentata, tracciabilità seriale, test funzionale e collaudo secondo standard ISO 9001.</strong></p>

    <h3 style="color:#00ffb3;">🔧 Laboratorio LEDwall dedicato</h3>
    <p>Disponiamo inoltre di un'area tecnica specifica per la riparazione, calibrazione e sostituzione componenti di <strong>LEDwall modulari indoor/outdoor</strong>:</p>
    <ul class="custom-list">
      <li>Analisi e sostituzione di moduli SMD (RGB 3-in-1, COB, miniLED);</li>
      <li>Ripristino controller, riceventi, alimentatori e ribbon cable;</li>
      <li>Taratura luminosa e mappatura pixel su software proprietari;</li>
      <li>Backup e restore firmware per schede NovaStar, ColorLight, Linsn, Brompton.</li>
    </ul>

    <p>Il nostro team è abilitato a operare su installazioni fisse, strutture mobili e rental, con servizio di <strong>supporto tecnico pre e post-evento</strong>, documentazione tecnica e formazione all'utilizzo.</p>
  `;
  break;
  }

  // Nascondi la galleria se visibile
  document.getElementById('gallery-view').style.display = 'none';

  if (modal.classList.contains('show')) {
    modal.classList.remove('show');
    modal.classList.add('fade-out');
    setTimeout(() => {
      modalContent.innerHTML = contenuto;
      showModalWithScroll();
      isTransitioning = false;
    }, 600);
  } else {
    modalContent.innerHTML = contenuto;
    showModalWithScroll();
    isTransitioning = false;
  }
}

// Funzione per aprire la galleria showroom
function apriShowroom(tipo) {
  if (isTransitioning) return;
  isTransitioning = true;
  
  // Nascondi il modal se aperto
  if (modal.classList.contains('show')) {
    modal.classList.remove('show');
    modal.classList.add('fade-out');
  }
  
  // Prepara la galleria
  const galleryContainer = document.getElementById('gallery-container');
  galleryContainer.innerHTML = ''; // Pulisci la galleria
  
  // Determina il percorso della cartella in base al tipo
  const folderPath = tipo === 'service' ? 'media/Service_e_Spettacolo/' : 'media/Sicurezza_Antincendio/';
  
  // Simula il caricamento di immagini e video dalla cartella
  // In un'implementazione reale, qui si dovrebbe fare una richiesta AJAX o utilizzare un'API per ottenere i file
  const mediaFiles = [];
  
  // Simula 10 immagini e 5 video per ogni categoria
  for (let i = 1; i <= 10; i++) {
    mediaFiles.push({
      type: 'image',
      src: `${folderPath}img${i}.jpg`,
      thumbnail: `${folderPath}img${i}.jpg`
    });
  }
  
  for (let i = 1; i <= 5; i++) {
    mediaFiles.push({
      type: 'video',
      src: `${folderPath}vd${i}.mp4`,
      thumbnail: `${folderPath}vd${i}.jpg` // Thumbnail per il video
    });
  }
  
  // Crea gli elementi della galleria
  mediaFiles.forEach((file, index) => {
    const galleryItem = document.createElement('div');
    galleryItem.className = 'gallery-item';
    galleryItem.dataset.index = index;
    
    if (file.type === 'image') {
      const img = document.createElement('img');
      img.src = file.thumbnail;
      img.alt = `Immagine ${index + 1}`;
      galleryItem.appendChild(img);
    } else if (file.type === 'video') {
      const video = document.createElement('video');
      video.src = file.src;
      video.muted = true;
      video.loop = true;
      video.autoplay = false;
      video.preload = 'metadata';
      
      // Aggiungi l'indicatore di video
      const indicator = document.createElement('div');
      indicator.className = 'video-indicator';
      indicator.textContent = 'VIDEO';
      galleryItem.appendChild(indicator);
      
      // Imposta l'anteprima del video
      const img = document.createElement('img');
      img.src = file.thumbnail;
      img.alt = `Video ${index + 1}`;
      galleryItem.appendChild(img);
      
      // Quando il mouse passa sopra, mostra un'anteprima del video
      galleryItem.addEventListener('mouseenter', () => {
        img.style.display = 'none';
        galleryItem.appendChild(video);
        video.play();
      });
      
      galleryItem.addEventListener('mouseleave', () => {
        video.pause();
        galleryItem.removeChild(video);
        img.style.display = 'block';
      });
    }
    
    // Aggiungi l'evento di click per la visualizzazione a schermo intero
    galleryItem.addEventListener('click', () => {
      openFullscreen(file);
    });
    
    galleryContainer.appendChild(galleryItem);
  });
  
  // Mostra la galleria
  document.getElementById('gallery-view').style.display = 'block';
  
  setTimeout(() => {
    isTransitioning = false;
  }, 600);
}

// Funzione per aprire la visualizzazione a schermo intero
function openFullscreen(file) {
  const fullscreenView = document.getElementById('fullscreen-view');
  const fullscreenContent = document.getElementById('fullscreen-content');
  
  // Pulisci il contenuto precedente
  fullscreenContent.innerHTML = '';
  
  // Crea il pulsante di chiusura
  const closeButton = document.createElement('button');
  closeButton.className = 'close-fullscreen';
  closeButton.innerHTML = '&times;';
  closeButton.addEventListener('click', (e) => {
    e.stopPropagation();
    closeFullscreen();
  });
  fullscreenContent.appendChild(closeButton);
  
  // Aggiungi il contenuto in base al tipo di file
  if (file.type === 'image') {
    const img = document.createElement('img');
    img.src = file.src;
    img.alt = 'Immagine a schermo intero';
    fullscreenContent.appendChild(img);
  } else if (file.type === 'video') {
    const video = document.createElement('video');
    video.src = file.src;
    video.controls = true;
    video.autoplay = true;
    video.loop = false; // Non ripetere automaticamente
    fullscreenContent.appendChild(video);
  }
  
  // Mostra la vista a schermo intero
  fullscreenView.classList.add('active');
  
  // Aggiungi anche un listener di click sul fullscreenView per chiuderlo
  fullscreenView.addEventListener('click', (e) => {
    if (e.target === fullscreenView) {
      closeFullscreen();
    }
  });
}

// Funzione per chiudere la visualizzazione a schermo intero
function closeFullscreen() {
  const fullscreenView = document.getElementById('fullscreen-view');
  fullscreenView.classList.remove('active');
  
  // Ferma eventuali video in riproduzione
  const video = fullscreenView.querySelector('video');
  if (video) {
    video.pause();
  }
}

function attivaSlideshow() {
  // Implementazione del slideshow (mantenuta dalla versione originale)
}

// Inizializzazione al caricamento della pagina
document.addEventListener('DOMContentLoaded', function() {
  // Animazione del sidebar
  document.getElementById('sidebar').classList.add('animated');
  
  // Randomizza le durate dell'effetto outline per ogni menu-item
  document.querySelectorAll('.menu-item').forEach(el => {
    const delay = (Math.random() * 3).toFixed(2) + 's';
    const speed = (5 + Math.random() * 1.5).toFixed(2) + 's';
    el.style.setProperty('--delay', delay);
    el.style.setProperty('--duration', speed);
  });
  
  // Aggiungi l'effetto "pressed" ai pulsanti del menu
  document.querySelectorAll('.menu-item').forEach(item => {
    item.addEventListener('mousedown', function() {
      this.classList.add('pressed');
    });
    
    item.addEventListener('mouseup', function() {
      this.classList.remove('pressed');
    });
    
    item.addEventListener('mouseleave', function() {
      this.classList.remove('pressed');
    });
  });
  
  // Chiudi la vista a schermo intero con il tasto ESC
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeFullscreen();
    }
  });
  
  // SOLO MOBILE: inietta "×", abilita touch su "Clicca qui" e avvia showroom
  if (window.matchMedia('(max-width: 768px)').matches) {
    const modal = document.getElementById('modal');
    const modalContent = document.getElementById('modal-content');

    // Collega il click sulla "×" per chiudere la modale
    modal.querySelectorAll('.modal-close').forEach(btn => {
      btn.addEventListener('click', () => {
        // SE la modale attualmente mostrata è quella di benvenuto E il suo timer è attivo
        if (modal.classList.contains('show') && modalContent.innerHTML.includes("Base Elettronica Service") && autoHide !== null) {
          clearTimeout(autoHide);
          autoHide = null;
          document.getElementById('modal-blocker').style.display = 'none'; // Assicurati che il blocker sia nascosto
        }
        modal.classList.remove('show');
        modal.classList.add('fade-out');
        setTimeout(() => {
          modal.classList.remove('fade-out');
          modalContent.innerHTML = ''; // Svuota sempre il contenuto dopo il fade-out
        }, 600);
      });
    });

    // Assicura che su touch "Clicca qui" parta la showroom
    document.querySelectorAll('span[onclick="attivaSlideshow()"]').forEach(el => {
      el.addEventListener('touchstart', e => {
        e.preventDefault();  // evita doppio tap
        attivaSlideshow();
      }, { passive: false });
    });
  }
  
  // Fai sì che cliccando logo o immagine si richiami ripristinaMenuPrincipale
  const logoBtn = document.getElementById('logo-btn');
  logoBtn.style.cursor = 'pointer';
  logoBtn.addEventListener('click', ripristinaMenuPrincipale);
  
  // ===== gestione "pressed" via Pointer Events con rilascio rallentato =====
  document.querySelectorAll('.menu-item').forEach(el => {
    el.addEventListener('pointerdown', () => {
      el.classList.add('pressed');
    });
    el.addEventListener('pointerup', () => {
      // aspetta un po' prima di farlo risalire, così l'animazione è ben visibile
      setTimeout(() => el.classList.remove('pressed'), 300);
    });
    el.addEventListener('pointerleave', () => {
      // se esco dal bottone, tolgo subito
      el.classList.remove('pressed');
    });
    el.addEventListener('pointercancel', () => {
      el.classList.remove('pressed');
    });
  });
});

// Gestione dell'orientamento per dispositivi mobili
window.addEventListener('orientationchange', function() {
  const warning = document.getElementById('orientation-warning');
  
  if (window.orientation === 90 || window.orientation === -90) {
    warning.style.display = 'flex';
  } else {
    warning.style.display = 'none';
  }
});

// Verifica iniziale dell'orientamento
if (window.orientation === 90 || window.orientation === -90) {
  document.getElementById('orientation-warning').style.display = 'flex';
}

// Event delegation per il form di contatto
document.addEventListener('submit', function(e) {
  if (e.target.matches('#contact-form')) {
    e.preventDefault();
    modalContent.innerHTML = `
      <div style="text-align:center; padding:1em;">
        <h2>Grazie di averci contattato!</h2>
        <p>Risponderemo entro 24 ore.</p>
      </div>`;
    modal.classList.remove('fade-out');
    modal.classList.add('show');
    setTimeout(() => {
      modal.classList.remove('show');
      modal.classList.add('fade-out');
      setTimeout(() => {
        modalContent.innerHTML = contenutoHome;
        currentIndex = null;
      }, 600);
    }, 3000);
  }
});

// Pianifica il pop-up di benvenuto
let autoHide = null;
let welcomeTimeout = setTimeout(() => {
  const blocker = document.getElementById('modal-blocker');
  const modal = document.getElementById('modal');
  const modalContent = document.getElementById('modal-content');

  modalContent.innerHTML = contenutoHome;
  blocker.style.display = 'block';
  modal.classList.add('show');

  // Timeout automatico globale
  autoHide = setTimeout(() => {
    // Chiude solo se la modale è ancora la stessa
    if (modal.classList.contains('show') && modalContent.innerHTML.includes("Base Elettronica Service")) {
      modal.classList.remove('show');
      blocker.style.display = 'none';
    }
    autoHide = null;
  }, 8000);

  const hideOnPointerDown = () => {
    if (autoHide !== null) {
      clearTimeout(autoHide);
      autoHide = null;
    }
    modal.classList.remove('show');
    blocker.style.display = 'none';
    document.removeEventListener('pointerdown', hideOnPointerDown, true);
  };

  blocker.addEventListener('pointerdown', hideOnPointerDown, true);
}, 500);

// Funzione per verificare l'orientamento
(function() {
  function checkOrientation() {
    const w = document.getElementById('orientation-warning');
    const isMobile = /Mobi|Android/i.test(navigator.userAgent);
    const isLandscape = window.innerWidth > window.innerHeight;
    if (isMobile && isLandscape) {
      w.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    } else {
      w.style.display = 'none';
      document.body.style.overflow = '';
    }
  }
  // Chiama subito e rilancia ad ogni resize/orientationchange
  window.addEventListener('load', checkOrientation);
  window.addEventListener('resize', checkOrientation);
  window.addEventListener('orientationchange', checkOrientation);
})();

    </script>
</body>
</html>
